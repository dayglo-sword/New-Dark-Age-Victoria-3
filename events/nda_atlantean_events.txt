namespace = nda_atlantean # Sourcerous exiles of Atlantis

# Platonic https://www.arcus-atlantis.org.uk/atlantis/who-were-the-atlanteans.html


# Move Atlantis historical events here???

nda_atlantean.10 = { # Tomb of Surama found in North Africa - remanant of atlantean colonies - Lovecraft
	type = country_event
	placement = p:xC46661 # Sahara
	
	title = nda_atlantean.10.t
	desc = nda_atlantean.10.d
	flavor = nda_atlantean.10.f
	
	duration = 3
	
    event_image = {
		video = "unspecific_steam_ship"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	
	icon = "gfx/interface/icons/event_icons/event_nda_cthulhu.dds"

	trigger = {		
		# regional
		game_date >=  1871.3.23
		game_date <  1872.1.1 

		# owner of - only they get
		OR = {
			p:xC46661 = { state = { owner = ROOT } }
			has_interest_marker_in_region = p:xC46661.region			
		}
	}


 	cooldown = { days= 370 }

 	immediate = {
 		p:xC46661 = { state = { save_scope_as = target_country } }

		# # if non-colonial country capable of agitators - then Surama appears	
		# if = {
		# 	limit = { 
		# 		p:xC46661 = { 
		# 			state = { 
		# 				owner = {
		# 					THIS = ROOT 
		# 					NOT = { is_country_type = decentralized }
		# 					is_revolutionary = no
		# 					coa_def_african_trigger = 	yes
		# 				} 
		# 			} 
		# 		}
		# 	}
		# 	# make room to add character
		# 	if= {
		# 		limit = { empty_agitator_slots = 0 }
				
		# 		random_scope_character = {
		# 			limit = { 
		# 				has_role = agitator 
		# 				# is not existing Altantean
		# 			}
		# 			exile_character_with_martyrdom = yes
		# 		}
		# 	}

		# 	# add cultural acceptance
		# 	add_culture_acceptance_modifier = {
		# 		culture = cu:nda_cul_atlantean
		# 		multiplier = 40
		# 	}

		# 	# add surama as agitator to country
		# 	if = {
		# 		limit = {
		# 			NOT = {
		# 				any_scope_character = {
		# 					has_template = nda_surama_character_template
		# 				}
		# 			}
		# 		}

		# 		create_character = {
		# 			template = nda_surama_character_template

		# 			on_created = {					
		# 				set_variable = memento_mori_immunity
		# 				set_character_immortal = yes
		# 				set_interest_group = prev.ig:ig_landowners
		# 				#save_scope_as = scope_sumara
		# 			}
		# 		}

		# 		random_scope_character = {
		# 			limit = { has_template = nda_surama_character_template }

		# 			add_character_role = agitator
		# 		}
		# 		debug_log = "Sumara set as Agitator in [THIS.GetCountry.GetNameNoFormatting]"
		# 	}



		# 	add_journal_entry = {
		# 		type = je_nda_atlantean_surama
		# 	}
		# 	#trigger_event = { id = nda_atlantean.11 days = 21} # event or journal?
		# }
		# else = {
		# 	# find nearest suitable country - probably Massina 
		# 	random_country = {
		# 		limit = {
		# 			NOT = { is_country_type = decentralized }
		# 			is_revolutionary = no	
		# 			is_adjacent_to_country = ROOT	
		# 			coa_def_african_trigger = 	yes
		# 		}
		# 		# make room to add character
		# 		if= {
		# 			limit = { empty_agitator_slots = 0 }
					
		# 			random_scope_character = {
		# 				limit = { 
		# 					has_role = agitator 
		# 					# is not existing Altantean
		# 				}
		# 				exile_character_with_martyrdom = yes
		# 			}
		# 		}

		# 		# add cultural acceptance - try and stop instant exile
		# 		add_culture_acceptance_modifier = {
		# 			culture = cu:nda_cul_atlantean
		# 			multiplier = 40
		# 		}

		# 		# add surama as agitator to country
		# 		if = {
		# 			limit = {
		# 				NOT = {
		# 					any_scope_character = {
		# 						has_template = nda_surama_character_template
		# 					}
		# 				}
		# 			}

		# 			create_character = {
		# 				template = nda_surama_character_template

		# 				on_created = {					
		# 					set_variable = memento_mori_immunity
		# 					set_character_immortal = yes
		# 					#save_scope_as = scope_sumara
		# 					set_interest_group = prev.ig:ig_landowners
		# 				}
		# 			}

		# 			random_scope_character = {
		# 				limit = { has_template = nda_surama_character_template }

		# 				add_character_role = agitator
		# 			}
		# 			debug_log = "Sumara set as Agitator in [THIS.GetCountry.GetNameNoFormatting]"
		# 		}

		# 		add_journal_entry = {
		# 			type = je_nda_atlantean_surama
		# 		}
		# 		#trigger_event = { id = nda_atlantean.11 days = 21} # event or journal?				
		# 	}
		# }
 	}	

	
	option = {
		name = nda_atlantean.10.a # Accept the cultists - set up conditions to allow nda_base.5 to run
		default_option = yes

		trigger = {
			p:xC46661 = { state = { owner = ROOT } }
		}

		# if non-colonial country capable of agitators - then Surama appears	
		if = {
			limit = { 
				p:xC46661 = { 
					state = { 
						owner = {
							THIS = ROOT 
							NOT = { is_country_type = decentralized }
							is_revolutionary = no
							coa_def_african_trigger = 	yes
						} 
					} 
				}
			}
			# make room to add character
			if= {
				limit = { empty_agitator_slots = 0 }
				
				random_scope_character = {
					limit = { 
						has_role = agitator 
						# is not existing Altantean
					}
					exile_character_with_martyrdom = yes
				}
			}

			# # add cultural acceptance
			# add_culture_acceptance_modifier = {
			# 	culture = cu:nda_cul_atlantean
			# 	multiplier = 40
			# }

			# add surama as agitator to country
			if = {
				limit = {
					NOT = {
						any_scope_character = {
							has_template = nda_surama_character_template
						}
					}
				}

				create_character = {
					template = nda_surama_character_template
					interest_group = ig_landowners
					on_created = {					
						set_variable = memento_mori_immunity
						set_character_immortal = yes
						#save_scope_as = scope_sumara
					}
				}

				random_scope_character = {
					limit = { has_template = nda_surama_character_template }

					add_character_role = agitator
				}
				debug_log = "Sumara set as Agitator in [THIS.GetCountry.GetNameNoFormatting]"
			}

			add_journal_entry = {
				type = je_nda_atlantean_surama
			}
			#trigger_event = { id = nda_atlantean.11 days = 21} # event or journal?
		}
		else = {
			# find suitable country
			ordered_country = {
				limit = {
					NOT = { is_country_type = decentralized }
					is_revolutionary = no	
					is_adjacent_to_country = ROOT	
					coa_def_african_trigger = 	yes
				}

				order_by = { subtract = global_country_ranking }
				max = 1	

				# make room to add character
				if= {
					limit = { empty_agitator_slots = 0 }
					
					random_scope_character = {
						limit = { 
							has_role = agitator 
							# is not existing Altantean
						}
						exile_character_with_martyrdom = yes
					}
				}

				# # add cultural acceptance - try and stop instant exile
				# add_culture_acceptance_modifier = {
				# 	culture = cu:nda_cul_atlantean
				# 	multiplier = 40
				# }

				# add surama as agitator to country
				if = {
					limit = {
						NOT = {
							any_scope_character = {
								has_template = nda_surama_character_template
							}
						}
					}

					create_character = {
						template = nda_surama_character_template
						interest_group = ig_landowners

						on_created = {					
							set_variable = memento_mori_immunity
							set_character_immortal = yes
							#save_scope_as = scope_sumara

						}
					}

					random_scope_character = {
						limit = { has_template = nda_surama_character_template }

						add_character_role = agitator
					}
					debug_log = "Sumara set as Agitator in [THIS.GetCountry.GetNameNoFormatting]"
				}

				add_journal_entry = {
					type = je_nda_atlantean_surama
				}
				#trigger_event = { id = nda_atlantean.11 days = 21} # event or journal?				
			}
		}

	}

	option = { # Default for non-owner 'news'
		name = nda_atlantean.10.b # 
		trigger = {
			NOT = { p:xC46661 = { state = { owner = ROOT } } }
		}
	}
 }


# The return of Surama - one off pulp style revival from certain death
nda_atlantean.11 = {
	type = country_event
	placement = ROOT
	
	title = nda_atlantean.11.t
	desc = nda_atlantean.11.d
	flavor = nda_atlantean.11.f
	
	duration = 3
	
    event_image = {
		video = "unspecific_steam_ship"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	
	icon = "gfx/interface/icons/event_icons/event_nda_cthulhu.dds"

	option = {
		name = nda_atlantean.11.a # 
	}
}

 # Kathulos Washed up in Africa, should favour egypt as base - Robert Howard
 nda_atlantean.20 = { #
	type = country_event
	placement = p:xC46661 # Sahara
	
	title = nda_atlantean.20.t
	desc = nda_atlantean.20.d
	flavor = nda_atlantean.20.f
	
	duration = 3
	
    event_image = {
		video = "unspecific_steam_ship"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	
	icon = "gfx/interface/icons/event_icons/event_nda_cthulhu.dds"

	trigger = {		
		# regional
		game_date >=  1871.3.23
		game_date <  1872.1.1 

		# owner of - only they get
		OR = {
			p:xC46661 = { state = { owner = ROOT } }
			has_interest_marker_in_region = p:xC46661.region			
		}
	}


 	cooldown = { days= 370 }

 	immediate = {
 		p:xC46661 = { state = { save_scope_as = target_country } }

 	}	

	
	option = {
		name = nda_atlantean.20.a # Accept the cultists - set up conditions to allow nda_base.5 to run
		default_option = yes

		trigger = {
			p:xC46661 = { state = { owner = ROOT } }
		}

		# if non-colonial country capable of agitators - then Surama appears	
		if = {
			limit = { 
				p:xC46661 = { 
					state = { 
						owner = {
							THIS = ROOT 
							NOT = { is_country_type = decentralized }
							is_revolutionary = no
							coa_def_african_trigger = 	yes
						} 
					} 
				}
			}
			# make room to add character
			if= {
				limit = { empty_agitator_slots = 0 }
				
				random_scope_character = {
					limit = { 
						has_role = agitator 
						# is not existing Altantean
					}
					exile_character_with_martyrdom = yes
				}
			}

			# # add cultural acceptance
			# add_culture_acceptance_modifier = {
			# 	culture = cu:nda_cul_atlantean
			# 	multiplier = 40
			# }

			# add surama as agitator to country
			if = {
				limit = {
					NOT = {
						any_scope_character = {
							has_template = nda_surama_character_template
						}
					}
				}

				create_character = {
					template = nda_surama_character_template
					interest_group = ig_landowners
					on_created = {					
						set_variable = memento_mori_immunity
						set_character_immortal = yes
						#save_scope_as = scope_sumara
					}
				}

				random_scope_character = {
					limit = { has_template = nda_surama_character_template }

					add_character_role = agitator
				}
				debug_log = "Sumara set as Agitator in [THIS.GetCountry.GetNameNoFormatting]"
			}

			add_journal_entry = {
				type = je_nda_atlantean_surama
			}
			#trigger_event = { id = nda_atlantean.11 days = 21} # event or journal?
		}
		else = {
			# find suitable country
			ordered_country = {
				limit = {
					NOT = { is_country_type = decentralized }
					is_revolutionary = no	
					is_adjacent_to_country = ROOT	
					coa_def_african_trigger = 	yes
				}

				order_by = { subtract = global_country_ranking }
				min = 1	

				# make room to add character
				if= {
					limit = { empty_agitator_slots = 0 }
					
					random_scope_character = {
						limit = { 
							has_role = agitator 
							# is not existing Altantean
						}
						exile_character_with_martyrdom = yes
					}
				}

				# add surama as agitator to country
				if = {
					limit = {
						NOT = {
							any_scope_character = {
								has_template = nda_surama_character_template
							}
						}
					}

					create_character = {
						template = nda_surama_character_template
						interest_group = ig_landowners

						on_created = {					
							set_variable = memento_mori_immunity
							set_character_immortal = yes
							#save_scope_as = scope_sumara

						}
					}

					random_scope_character = {
						limit = { has_template = nda_surama_character_template }

						add_character_role = agitator
					}
					debug_log = "Sumara set as Agitator in [THIS.GetCountry.GetNameNoFormatting]"
				}

				add_journal_entry = {
					type = je_nda_atlantean_surama
				}
				#trigger_event = { id = nda_atlantean.11 days = 21} # event or journal?				
			}
		}

	}

	option = { # Default for non-owner 'news'
		name = nda_atlantean.20.b # 
		trigger = {
			NOT = { p:xC46661 = { state = { owner = ROOT } } }
		}
	}
 }
# nda_atlantean.30 = { } # Washed up in Pacific - Lovecraft

# atlanteans boost native rebel movements in location and neighbourhood
nda_atlantean.40 = { 
	type = country_event
	placement = ROOT
	
	title = nda_atlantean.40.t
	desc = nda_atlantean.40.d
	flavor = nda_atlantean.40.f
	
	duration = 3
	
    event_image = {
		video = "unspecific_steam_ship"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	
	icon = "gfx/interface/icons/event_icons/event_nda_cthulhu.dds"

	option = {
		name = nda_atlantean.40.a # 
	}
}

# Notifiy of culture adopting unify trait

nda_atlantean.41 = { 
	type = country_event
	placement = ROOT
	
	title = nda_atlantean.41.t
	desc = nda_atlantean.41.d
	flavor = nda_atlantean.41.f
	
	duration = 3
	
    event_image = {
		video = "unspecific_steam_ship"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	
	icon = "gfx/interface/icons/event_icons/event_nda_cthulhu.dds"

	option = {
		name = nda_atlantean.41.a # 
	}

} 