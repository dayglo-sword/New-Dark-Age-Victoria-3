namespace = nda_ares # Ares

nda_ares.10 = { # Early Landing
	type = country_event
	placement = p:x60A040 #East Anglia
	title = nda_ares.10.t
	desc = nda_ares.10.d
	flavor =  nda_ares.10.f

	duration = 3

	event_image = {
		video = "gfx/event_pictures/southamerica_christianity.bk2"		
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_default.dds"

	trigger = {
 		# 1842 and owner of East Anglia 
		game_date >= 1842.3 
		game_date < 1843
		p:x60A040 = { state = { owner = ROOT } }
		NOT = { has_global_variable = nda_ares_invasion }

	}

	cooldown = { months = 12 }

	immediate = {
		
		set_global_variable = nda_ares_invasion

		# record target country ready to start war later
		p:x60A040.state.owner = {
			save_scope_as = nda_ares_first_victim
		}

		change_relations = { country = c:NDA_ARES value = -100 } # is this too much ?
		# create country
		create_country = {
			tag = NDA_ARES
			origin = this

			state = p:x60A040.state 
			province = p:x60E0C0
			province = p:x19CECD
			province = p:x58D3AE

			on_created = {
				nda_effect_martian_setup = yes

				every_scope_state = {
					kill_population_percent_in_state = { percent = 0.20 }
					# convert large chunk of remaining to give them a start
					convert_population = { target = rel:atheist value = 0.6  }

					every_scope_pop = {
						change_pop_culture = { target = cu:nda_cul_aresian value = 0.6 }		
					}

					# add generator building - should be landing sites then upgrade to generators?
					create_building={
						building = "building_nda_ares_generators" 
					}	

					state_region = {
						add_homeland = nda_cul_aresian						
					}

					add_modifier = { name = nda_ares_state_red_lands_modifier }
				}

				# lay claim to neighbouring states
				every_neighbouring_state = {
					limit = { NOT = { owner = c:NDA_ARES } }
					state_region = {
						add_homeland = nda_cul_aresian		
						add_claim = c:NDA_ARES
					}
					add_radicals = { value = 0.5 } # Panic in the streets of London...

					add_modifier = {
						name = nda_ares_state_martian_terror_modifier
					}
				}	
				
				IF = {
					limit = {
						exists = c:FRA
					}
					set_secret_goal = {
						country = c:FRA
						secret_goal = conquer
					}			
				}
				IF = {
					limit = {
						exists = c:USA
					}
					set_secret_goal = {
						country = c:USA
						secret_goal = conquer
					}			
				}
				IF = {
					limit = {
						exists = c:PRU
					}
					set_secret_goal = {
						country = c:PRU
						secret_goal = conquer
					}			
				}
				IF = {
					limit = {
						exists = c:RUS
					}
					set_secret_goal = {
						country = c:RUS
						secret_goal = conquer
					}			
				}
			}
			
		}

		# should not be liked by any one
		every_country = {
			limit = {
				NOT = { c:NDA_ARES ?= THIS }
			}
			change_relations = { country = c:NDA_ARES value = -150 } # is this too much ?
		}

		#go to war
		c:NDA_ARES = {
			create_diplomatic_play = {
				name = nda_ares_dp_martian_invasion
			
				target_country = scope:nda_ares_first_victim

				war = yes 
				
				type = dp_annex_war # dp_conquer_state - can't be done ??

				# add_war_goal = {
				# 	holder = c:NDA_ARES
				# 	type = conquer_state
				# 	target_state = p:x7543C8.state #  London
				# }
			} 			
		}

		debug_log = "Ares - Start"
	}	
	
	option = {
		name = nda_ares.10.a
		default_option = yes
	}

}	

nda_ares.20 = { # Mars Attacks 
	type = country_event
	placement = ROOT
	title = nda_ares.20.t
	desc = nda_ares.20.d
	flavor =  nda_ares.20.f

	duration = 3

	event_image = {
		video = "gfx/event_pictures/unspecific_politicians_arguing.bk2"
		
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/tutorial_icon.dds"

	trigger = {
 		exists = c:NDA_ARES
		c:NDA_ARES = { is_at_war = no } # need to try and provoke
	}
	
	immediate = {
		set_variable = nda_nameless_cults_decision # don't set immediate as causes follow on event to trigger simultaniously	
		debug_log = "Imprint of Nameless Cults : [THIS.GetCountry.GetNameNoFormatting]" 
	}	
	
	option = {
		name = nda_ares.20.a
		default_option = yes

	}

	option = { 
		name = nda_ares.20.b

		ai_chance = { # will -ve effect conversion rate
			base = 25
		}

	}
}
