je_nda_atlantean_surama = {
	icon = "gfx/interface/icons/event_icons/event_nda_cthulhu.dds" 

	group = je_group_nda_eldritch
	
	possible = {

		custom_tooltip = {
			text = je_nda_atlantean_surama_is_present_tt

			any_scope_character = {
				has_template = nda_surama_character_template
			}			
		}

	}	

	immediate = {
		debug_log = "Atlantean - Sumara target country [THIS.GetCountry.GetNameNoFormatting]"
	}

	modifiers_while_active = {
		# Reduce movements over all
	}


	on_weekly_pulse = {		
	}

	on_monthly_pulse = {

		effect = {
			random_list = {
				5 = {
					# do nothing
				}
				4 = {
					# spread support for neighbouring anti-colonial nationalist move
					if = {
						limit = {
							any_neighbouring_state = {
								NOT = { OWNER = ROOT }
								OWNER = {
									any_political_movement = {
										is_political_movement_type = movement_cultural_minority	
										culture = { has_discrimination_trait_group =  heritage_group_african }
										NOT = { has_modifier = nda_covert_support_modifier }		
 									}								
								}									
							}
						}

						debug_log = "Spread Support to neighbour cultures: [THIS.GetCountry.GetNameNoFormatting]"
						random_neighbouring_state = {
							limit = {				
								NOT = { OWNER = ROOT }
								OWNER = {
									any_political_movement = {
										is_political_movement_type = movement_cultural_minority	
										culture ?= { has_discrimination_trait_group =  heritage_group_african }
										NOT = { has_modifier =nda_covert_support_modifier }		
									}								
								}									
							}
						
							OWNER = {
								every_political_movement = {
									limit = {
										is_political_movement_type = movement_cultural_minority	
										culture ?= { has_discrimination_trait_group =  heritage_group_african }	
										NOT = { has_modifier =nda_covert_support_modifier }						
									}

									add_modifier = nda_covert_support_modifier
								}

								# fire event to notify owner
								trigger_event = { id = nda_atlantean.40 days=7 }
							}
						}							
					}
				}				
				1 = {
					# check local culture - give it tradition for Grand Unity
					ROOT = {
						if = {
							limit = { 
								any_primary_culture = { 
									has_discrimination_trait_group = heritage_group_african
									not = { has_discrimination_trait = tradition_nda_grand_union }
								}
							}

							debug_log = "Spread Grand Union tradition : [THIS.GetCountry.GetNameNoFormatting]"
							random_primary_culture = {
								limit = { 
									has_discrimination_trait_group = heritage_group_african
									not = { has_discrimination_trait = tradition_nda_grand_union }								
								}
								add_tradition_trait = tradition_nda_grand_union		
								save_scope_as = converted_culture					
							}

							# fire event to notify owner
							every_country = {
								limit= {
									is_player = yes
									any_scope_pop = {
										culture = scope:converted_culture
									}
								}
								trigger_event = { id = nda_atlantean.41 days=7 }								
							}

						}
						else_if = {
							limit = {
								any_neighbouring_state = {
									owner = {
										any_primary_culture = { 
											has_discrimination_trait_group = heritage_group_african
											not = { has_discrimination_trait = tradition_nda_grand_union }
										}	
										save_temporary_scope_as = 	target_country							
									}
									
								}
							}
							scope:target_country = {	# spread to cultures in neighbouring country
								debug_log = "Spread Grand Union tradition : [THIS.GetCountry.GetNameNoFormatting]"
								random_primary_culture = {
									limit = { 
										has_discrimination_trait_group = heritage_group_african
										not = { has_discrimination_trait = tradition_nda_grand_union }								
									}
									add_tradition_trait = tradition_nda_grand_union		
									save_scope_as = converted_culture					
								}									
							}

							# fire event to notify owner
							every_country = {
								limit= {
									is_player = yes
									any_scope_pop = {
										culture = scope:converted_culture
									}
								}
								trigger_event = { id = nda_atlantean.41 days=7 }								
							}
						}
					
					}

				}
				1 = {
					# modifier to supress local movements to stop revolts, supress liberal
					ROOT = {
						if = {
							limit = { 
								any_political_movement = {
									movement_is_liberal = yes
									NOT = { has_modifier = nda_atlantean_suppresion_modifier }		
								}
							}

							debug_log = "Supress Local Movements : [THIS.GetCountry.GetNameNoFormatting]"

							every_political_movement = {
								limit = {
									movement_is_liberal = yes
									
									NOT = { has_modifier =nda_atlantean_suppresion_modifier }						
								}

								add_modifier = nda_atlantean_suppresion_modifier
							}

							# fire event to notify owner
						}
					}
				}
				1 = {
					# change strategy to be more expansionist.
					if = {
						limit = {
							is_player = no
						}

						if = {
							limit = {NOT = { has_strategy = ai_strategy_territorial_expansion } }
							set_strategy = ai_strategy_territorial_expansion
						}
						else_if = {
							limit = {NOT = { has_strategy = ai_strategy_nationalist_agenda } }
							set_strategy = ai_strategy_nationalist_agenda	
						}
						else_if = {
							limit = {NOT = { has_strategy = ai_strategy_resource_expansion } }
							set_strategy = ai_strategy_resource_expansion	
						}
					}
				}
				1 = {
					modifier = {
						if = {
							limit = {
								NOT = {
									any_country = {
										NOT = { is_country_type = decentralized }
										is_revolutionary = no	
										is_adjacent_to_country = ROOT	
										coa_def_african_trigger = yes								
									}									
								}
							}
							subtract = 1
						}
					}
					# Political lobby boost in any potential ally
					random_country = {
						limit = {
							NOT = { is_country_type = decentralized }
							is_revolutionary = no	
							is_adjacent_to_country = ROOT	
							coa_def_african_trigger = yes
						}

						debug_log = "Boost Lobbies : [THIS.GetCountry.GetNameNoFormatting]"

						change_relations = { country = ROOT value = 50 } # should be done by confirmation event if player
						# Boost in favour of Surama host
						create_diplomatic_catalyst = {  
							type = catalyst_event_positive
							target = ROOT
						}
					}
				}
				1 = {
					modifier = {
						if = {
							limit = {
								NOT = {
									any_country = {
										NOT = { is_country_type = decentralized }
										is_subject = yes	
										overlord = { coa_def_african_trigger = no }
										is_adjacent_to_country = ROOT	
										coa_def_african_trigger = yes									
									}									
								}
							}
							subtract = 1
						}
					}
					# If subject of non-local power then increase liberty desire
					random_country = {
						limit = {
							NOT = { is_country_type = decentralized }
							is_subject = yes	
							overlord = { coa_def_african_trigger = no }
							is_adjacent_to_country = ROOT	
							coa_def_african_trigger = yes
						}

						debug_log = "Increase Liberty Desire : [THIS.GetCountry.GetNameNoFormatting]"

						add_liberty_desire = 20

					}
				}
				1 = { # If host country is subject of non-african then boost liberty desire
					modifier = {
						if = {
							limit = {
								NOT = {
									NOT = { is_country_type = decentralized }
									is_subject = yes	
									overlord = { coa_def_african_trigger = no }
									coa_def_african_trigger = yes																		
								}
							}
							subtract = 1
						}
					}
					# If subject of non-local power then increase liberty desire
					debug_log = "Increase Liberty Desire in Host : [THIS.GetCountry.GetNameNoFormatting]"
					add_liberty_desire = 20
				}
			}
	
		}
	
	}

	on_yearly_pulse = {
		effect = {
			# update counts so we can see how much progress has been made
			# Count of Cultures with trait
			# Count of movements with modifier
		}
    }
	# current_value = {

	# }

	# goal_add_value = {
	
	# }

    # fail = {
    # }
	
	# on_fail = {	
	# }

	#timeout = 3000

	#progressbar = yes
	weight = 10

	can_deactivate = yes
	#inheritable = yes

	should_be_pinned_by_default = yes
}

je_nda_atlantean_kathulos = {
	icon = "gfx/interface/icons/event_icons/event_nda_cthulhu.dds" 

	group = je_group_nda_eldritch
	
	possible = {

		custom_tooltip = {
			text = je_nda_atlantean_kathulos_is_present_tt

			any_scope_character = {
				has_template = nda_kathulos_character_template
			}			
		}

	}	

	immediate = {
		debug_log = "Atlantean - Kathulos target country [THIS.GetCountry.GetNameNoFormatting]"
	}

	modifiers_while_active = {
		# Reduce movements over all
	}

	on_weekly_pulse = {		
	}

	on_monthly_pulse = {
		# Same effects as Surama but in middle east / north africa

		effect = {
			random_list = {
				5 = {
					# do nothing
				}
				4 = {
					# spread support for neighbouring anti-colonial nationalist move
					if = {
						limit = {
							any_neighbouring_state = {
								NOT = { OWNER = ROOT }
								OWNER = {
									any_political_movement = {
										is_political_movement_type = movement_cultural_minority	
										culture = { has_discrimination_trait_group =  heritage_group_african }
										NOT = { has_modifier = nda_covert_support_modifier }		
 									}								
								}									
							}
						}

						debug_log = "Spread Support to neighbour cultures: [THIS.GetCountry.GetNameNoFormatting]"
						random_neighbouring_state = {
							limit = {				
								NOT = { OWNER = ROOT }
								OWNER = {
									any_political_movement = {
										is_political_movement_type = movement_cultural_minority	
										culture ?= { has_discrimination_trait_group =  heritage_group_african }
										NOT = { has_modifier =nda_covert_support_modifier }		
									}								
								}									
							}
						
							OWNER = {
								every_political_movement = {
									limit = {
										is_political_movement_type = movement_cultural_minority	
										culture ?= { has_discrimination_trait_group =  heritage_group_african }	
										NOT = { has_modifier =nda_covert_support_modifier }						
									}

									add_modifier = nda_covert_support_modifier
								}

								# fire event to notify owner
								trigger_event = { id = nda_atlantean.40 days=7 }
							}
						}							
					}
				}				
				1 = {
					# check local culture - give it tradition for Grand Unity
					ROOT = {
						if = {
							limit = { 
								any_primary_culture = { 
									has_discrimination_trait_group = heritage_group_middle_eastern
									not = { has_discrimination_trait = tradition_nda_grand_union }
								}
							}

							debug_log = "Spread Grand Union tradition : [THIS.GetCountry.GetNameNoFormatting]"
							random_primary_culture = {
								limit = { 
									has_discrimination_trait_group = heritage_group_middle_eastern
									not = { has_discrimination_trait = tradition_nda_grand_union }								
								}
								add_tradition_trait = tradition_nda_grand_union		
								save_scope_as = converted_culture					
							}

							# fire event to notify owner
							every_country = {
								limit= {
									is_player = yes
									any_scope_pop = {
										culture = scope:converted_culture
									}
								}
								trigger_event = { id = nda_atlantean.41 days=7 }								
							}

						}
						else_if = {
							limit = {
								any_neighbouring_state = {
									owner = {
										any_primary_culture = { 
											has_discrimination_trait_group = heritage_group_middle_eastern
											not = { has_discrimination_trait = tradition_nda_grand_union }
										}	
										save_temporary_scope_as = 	target_country							
									}
									
								}
							}
							scope:target_country = {	# spread to cultures in neighbouring country
								debug_log = "Spread Grand Union tradition : [THIS.GetCountry.GetNameNoFormatting]"
								random_primary_culture = {
									limit = { 
										has_discrimination_trait_group = heritage_group_middle_eastern
										not = { has_discrimination_trait = tradition_nda_grand_union }								
									}
									add_tradition_trait = tradition_nda_grand_union		
									save_scope_as = converted_culture					
								}									
							}

							# fire event to notify owner
							every_country = {
								limit= {
									is_player = yes
									any_scope_pop = {
										culture = scope:converted_culture
									}
								}
								trigger_event = { id = nda_atlantean.41 days=7 }								
							}
						}
					
					}

				}
				1 = {
					# modifier to supress local movements to stop revolts, supress liberal
					ROOT = {
						if = {
							limit = { 
								any_political_movement = {
									movement_is_liberal = yes
									NOT = { has_modifier = nda_atlantean_suppresion_modifier }		
								}
							}

							debug_log = "Supress Local Movements : [THIS.GetCountry.GetNameNoFormatting]"

							every_political_movement = {
								limit = {
									movement_is_liberal = yes
									
									NOT = { has_modifier =nda_atlantean_suppresion_modifier }						
								}

								add_modifier = nda_atlantean_suppresion_modifier
							}

							# fire event to notify owner
						}
					}
				}
				1 = {
					# change strategy to be more expansionist.
					if = {
						limit = {
							is_player = no
						}

						if = {
							limit = {NOT = { has_strategy = ai_strategy_territorial_expansion } }
							set_strategy = ai_strategy_territorial_expansion
						}
						else_if = {
							limit = {NOT = { has_strategy = ai_strategy_nationalist_agenda } }
							set_strategy = ai_strategy_nationalist_agenda	
						}
						else_if = {
							limit = {NOT = { has_strategy = ai_strategy_resource_expansion } }
							set_strategy = ai_strategy_resource_expansion	
						}
					}
				}
				1 = {
					modifier = {
						if = {
							limit = {
								NOT = {
									any_country = {
										NOT = { is_country_type = decentralized }
										is_revolutionary = no	
										is_adjacent_to_country = ROOT	
										any_primary_culture = {
											has_discrimination_trait_group = heritage_group_middle_eastern
										}							
									}									
								}
							}
							subtract = 1
						}
					}
					# Political lobby boost in any potential ally
					random_country = {
						limit = {
							NOT = { is_country_type = decentralized }
							is_revolutionary = no	
							is_adjacent_to_country = ROOT	
							coa_def_african_trigger = yes
						}

						debug_log = "Boost Lobbies : [THIS.GetCountry.GetNameNoFormatting]"

						change_relations = { country = ROOT value = 50 } # should be done by confirmation event if player
						# Boost in favour of Surama host
						create_diplomatic_catalyst = {  
							type = catalyst_event_positive
							target = ROOT
						}
					}
				}
				1 = {
					modifier = {
						if = {
							limit = {
								NOT = {
									any_country = {
										NOT = { is_country_type = decentralized }
										is_subject = yes	
										overlord = { coa_def_african_trigger = no }
										is_adjacent_to_country = ROOT	
										any_primary_culture = {
											has_discrimination_trait_group = heritage_group_middle_eastern
										}									
									}									
								}
							}
							subtract = 1
						}
					}
					# If subject of non-local power then increase liberty desire
					random_country = {
						limit = {
							NOT = { is_country_type = decentralized }
							is_subject = yes	
							overlord = { coa_def_african_trigger = no }
							is_adjacent_to_country = ROOT	
							any_primary_culture = {
								has_discrimination_trait_group = heritage_group_middle_eastern
							}	
						}

						debug_log = "Increase Liberty Desire : [THIS.GetCountry.GetNameNoFormatting]"

						add_liberty_desire = 20

					}
				}
				1 = { # If host country is subject of non-african then boost liberty desire
					modifier = {
						if = {
							limit = {
								NOT = {
									NOT = { is_country_type = decentralized }
									is_subject = yes	
									overlord = { coa_def_african_trigger = no }
									coa_def_african_trigger = yes																		
								}
							}
							subtract = 1
						}
					}
					if = {
						limit = {
							is_subject = yes	
							overlord = { coa_def_african_trigger = no }							
						}
						# If subject of non-local power then increase liberty desire
						debug_log = "Increase Liberty Desire in Host : [THIS.GetCountry.GetNameNoFormatting]"
						add_liberty_desire = 20						
					}
				}
			}
	
		}
	
	}

	on_yearly_pulse = {
		effect = {
			# update counts so we can see how much progress has been made
			# Count of Cultures with trait
			# Count of movements with modifier
		}
    }
	# current_value = {

	# }

	# goal_add_value = {
	
	# }

    # fail = {
    # }
	
	# on_fail = {	
	# }

	#timeout = 3000

	#progressbar = yes
	weight = 10

	can_deactivate = yes
	#inheritable = yes

	should_be_pinned_by_default = yes
}