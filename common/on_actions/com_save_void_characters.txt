on_monthly_pulse = {
	on_actions = {
		on_com_save_structs
	}
}

on_com_save_structs = {
	effect = {
		ordered_country = {
			order_by = prestige
			position = 0
			save_temporary_scope_as = com_internal_prestige_leader
		}
		if = {
			limit = {
				exists = scope:com_internal_prestige_leader
				NOT = {
					global_var:com_internal_prestige_leader_old ?= scope:com_internal_prestige_leader
				}
			}
			every_character_in_void = {
				limit = {
					has_variable = is_struct
					NOT = {
						scope:com_internal_prestige_leader ?= owner
					}
				}
				transfer_character = scope:com_internal_prestige_leader
				set_variable = memento_mori_immunity
				if = {
					limit = {
						is_in_void = no
					}
					place_character_in_void = 10000
				}
				if = {
					limit = {
						is_immortal = no
					}
					set_character_immortal = yes
				}
			}
			set_global_variable = {
				name = com_internal_prestige_leader_old
				value = scope:com_internal_prestige_leader
			}
		}
	}
}